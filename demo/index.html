<!doctype html>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <title>exchange-timeline Demo</title>
    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="../exchange-timeline.html">
  </head>
  <body unresolved>


    <exchange-timeline access_token="9xMaEW1CW4K3RQEvFcsztQ))" key="XGiATUM3eJCNfJviQBxefw((" site="stackoverflow.com">
    </exchange-timeline>

    <script>
      document.addEventListener('WebComponentsReady', function(){
        setTimeout(function(){
          var all_elements = document.querySelector('exchange-timeline').getElementsByTagName('*')
          var functions= {
            '1.4.7': function(callback){
              var audioList = document.getElementsByTagName('audio');
              var avoid_override = [];
              var search = function(list, item){
                var finded = false;
                var i=-1;
                var elem;
                for(i=0;i<list.length && !finded;i++){
                  if (list[i] == item){
                    finded = true;
                    elem = list[i];
                  }
                }
                return --i;
              }
              var playCallback = function(e){
                var elem = e.target;
                elem.setAttribute('data-count-play',1);
               }.bind(this);
              var pauseCallback = function(e){
                var elem = e.target;
                elem.setAttribute('data-count-pause',1);
              }.bind(this);

              for(i=0;i<audioList.length;i++){
                avoid_override.push({onplay:audioList[i].onplay,onpause:audioList[i].onpause});
                audioList[i].onplay = playCallback;
                audioList[i].onpause = pauseCallback;
              }

              for(i=0;i<all_elements.length*2 && audioList.length > 0;i++){
                elem = all_elements[i%all_elements.length];
                if (elem.click && elem.tagName != 'A'){
                  elem.click();
                }
              }
              setTimeout(function(){
                var pass = true;
                for(i=0;i<audioList.length;i++){
                  audioList[i].onplay = avoid_override[i].onplay;
                  audioList[i].onpause = avoid_override[i].onplay;
                  var twoParam = audioList[i].getAttribute('data-count-play') == '1' && audioList[i].getAttribute('data-count-pause') == '1';
                  pass = twoParam && pass;
                }
                callback(pass);
              },0)

            }
          }
          var start = new Date();
          functions["1.4.7"](function(cumple){
            console.log('Cumple el 1.4.7', cumple);  
            console.log('Tiempo ejecucion: ', new Date() - start);
          });


        },500);
      })
    </script>

  </body>
</html>
